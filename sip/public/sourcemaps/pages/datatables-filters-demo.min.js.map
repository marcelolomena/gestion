{"version":3,"sources":["pages/datatables-filters-demo.js"],"names":["advanceDataTablesDemo","init","this","bindUIActions","table","handleDataTables","handleGlobalSearch","handleColumnSearch","handleSelecter","handleClearSelected","addFilterRow","removeFilterRow","clearFilter","buttons","container","appendTo","unwrap","$","DataTable","dom","extend","autoPrint","language","paginate","previous","next","autoWidth","ajax","deferRender","order","columns","data","className","orderable","searchable","_","sort","search","columnDefs","targets","render","type","row","meta","id","img","name","self","on","e","value","val","length","clearSelectedRows","draw","document","filterRow","parents","column","find","operator","pattern","exp","arr","split","each","i","lastIndex","_loop","x","target","is","trigger","rowTmpl","children","first","clone","prop","append","$row","isRemovableRow","remove","modal","isChecked","getSelectedInfo","$selectors","$selectedRow","$info","$badge","addClass","text","prepend"],"mappings":"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","file":"../../javascript/pages/datatables-filters-demo.min.js","sourcesContent":["// DataTables Demo\n// =============================================================\n\nconst advanceDataTablesDemo = {\n\n  init () {\n\n    this.bindUIActions()\n\n  },\n\n  bindUIActions () {\n\n    // event handlers\n    this.table = this.handleDataTables()\n    this.handleGlobalSearch()\n    this.handleColumnSearch()\n    this.handleSelecter()\n    this.handleClearSelected()\n\n    // filter columns\n    this.addFilterRow()\n    this.removeFilterRow()\n    this.clearFilter()\n\n    // add buttons\n    this.table.buttons().container()\n      .appendTo('#dt-buttons')\n      .unwrap()\n  },\n\n  handleDataTables () {\n    return $('#myTable').DataTable({\n      dom: `<'text-muted'Bi>\n        <'table-responsive'tr>\n        <'mt-4'p>`,\n      buttons: [\n        'copyHtml5',\n        { extend: 'print', autoPrint: false }\n      ],\n      language: {\n        paginate: {\n          previous: '<i class=\"fa fa-lg fa-angle-left\"></i>',\n          next: '<i class=\"fa fa-lg fa-angle-right\"></i>'\n        }\n      },\n      autoWidth: false,\n      ajax: 'assets/data/products.json',\n      deferRender: true,\n      order: [ 1, 'asc' ],\n      columns: [\n        { data: 'id', className: 'col-checker align-middle', orderable: false, searchable: false },\n        { data: { _: 'name', sort: 'name', search: 'name'}, className: 'align-middle' },\n        { data: 'inventory', className: 'align-middle' },\n        { data: 'variant', className: 'align-middle' },\n        { data: 'prices', className: 'align-middle' },\n        { data: 'sales', className: 'align-middle' },\n        { data: 'id', className: 'align-middle text-right', orderable: false, searchable: false }\n      ],\n      columnDefs: [{\n        targets: 0,\n        render: function (data, type, row, meta) {\n          return `<div class=\"custom-control custom-control-nolabel custom-checkbox\">\n            <input type=\"checkbox\" class=\"custom-control-input\" name=\"selectedRow[]\" id=\"p${row.id}\" value=\"${row.id}\">\n            <label class=\"custom-control-label\" for=\"p${row.id}\"></label>\n          </div>`\n        }\n      }, {\n        targets: 1,\n        render: function (data, type, row, meta) {\n          return `<a href=\"#${row.id}\" class=\"tile tile-img mr-1\">\n            <img class=\"img-fluid\" src=\"assets/images/dummy/img-${row.img}.jpg\" alt=\"Card image cap\">\n          </a>\n          <a href=\"#${row.id}\">${row.name}</a>`\n        }\n      }, {\n        targets: 6,\n        render: function (data, type, row, meta) {\n          return `<a class=\"btn btn-sm btn-secondary\" href=\"#${data}\"><i class=\"fa fa-pencil-alt\"></i></a>\n          <a class=\"btn btn-sm btn-secondary\" href=\"#${data}\"><i class=\"far fa-trash-alt\"></i></a>`\n        }\n      }]\n    })\n  },\n\n  handleGlobalSearch () {\n    const self = this\n\n    $('#table-search').on('keyup focus', function (e) {\n      let value = $('#table-search').val()\n\n      // clear selected rows\n      if (value.length && e.type === 'keyup') {\n        self.clearSelectedRows()\n      }\n\n      self.table\n        .search(value)\n        .draw()\n    })\n  },\n\n  handleColumnSearch () {\n    const self = this\n\n    $(document).on('keyup change', '.filter-control', function (e) {\n      const filterRow = $(this).parents('.form-row')\n      const column = filterRow.find('.filter-column').val()\n      const value = filterRow.find('.filter-value').val()\n      const operator = value === '' ? 'contain' : filterRow.find('.filter-operator').val()\n      let pattern = value\n      let exp = ''\n\n      if (operator === 'notcontain') {\n        pattern = '^((?!'+ value +').)*$'\n      } else if (operator === 'equal') {\n        pattern = '^'+ value +'$'\n      } else if (operator === 'notequal') {\n        pattern = '^(?!'+ value +').*$'\n      } else if (operator === 'beginwith') {\n        pattern = '^('+ value + '| '+ value + ').*'\n      } else if (operator === 'endwith') {\n        pattern = '.*' + value + '$'\n      } else if (operator === 'greaterthan') {\n        const arr = value.split('')\n\n        $.each(arr, function (i, val) {\n          exp += '['+ val +'-9]'\n        })\n\n        pattern = '^'+ exp +'*$'\n        console.log(pattern)\n      } else if (operator === 'lessthan') {\n        const arr = value.split('')\n        const lastIndex = arr.length - 1\n\n        for (let x = 0; x < arr.length; x++) {\n          exp += x > 0 ? '|' : ''\n\n          $.each(arr, function (i, val) {\n            if (i <= x && x === lastIndex) {\n              exp += '[0-'+ val +']'\n            } if (i <= x && x < lastIndex) {\n              exp += '[0-9]'\n            }\n          })\n        }\n\n        pattern = '^('+ exp +')$'\n      }\n\n      // reset search term\n      if (e.type === 'change' && $(e.target).is('select')) {\n        filterRow.find('.filter-value').val('').trigger('keyup')\n      }\n\n      self.table\n        .column(column)\n        .search(pattern, true, true)\n        .draw()\n    })\n  },\n\n  addFilterRow () {\n    $('#add-filter-row').on('click', function () {\n      // get template from #filter-columns\n      let rowTmpl = $('#filter-columns')\n        .children()\n        .first()\n        .clone()\n\n      rowTmpl.find('select').prop('selectedIndex', 0)\n      rowTmpl.find('input').val('')\n\n      $('#filter-columns').append(rowTmpl)\n    })\n  },\n\n  removeFilterRow () {\n    const self = this\n    $(document).on('click', '.remove-filter-row', function () {\n      // get filter row\n      let $row = $(this).parents('.filter-row')\n      // clear search value\n      $row.find('.filter-value').val('').trigger('keyup')\n      // remove row\n      if (self.isRemovableRow()) {\n        $row.remove()\n      }\n    })\n  },\n\n  isRemovableRow () {\n    return $('#filter-columns').children().length > 1\n  },\n\n  clearFilter () {\n    const self = this\n\n    $(document).on('click', '#clear-filter', function () {\n      // hide modal\n      $('#modalFilterColumns').modal('hide')\n\n      // reset selects and input\n      $('#filter-columns').find('select').prop('selectedIndex', 0)\n      $('#filter-columns').find('input').val('')\n\n      // reset search term\n      self.table\n        .columns()\n        .search('')\n        .draw();\n    })\n  },\n\n  handleSelecter () {\n    const self = this\n\n    $(document).on('change', '#check-handle', function () {\n      const isChecked = $(this).prop('checked')\n      $('input[name=\"selectedRow[]\"]').prop('checked', isChecked)\n\n      // get info\n      self.getSelectedInfo()\n    })\n    .on('change', 'input[name=\"selectedRow[]\"]', function () {\n      const $selectors = $('input[name=\"selectedRow[]\"]')\n      const $selectedRow = $('input[name=\"selectedRow[]\"]:checked').length\n      const prop = $selectedRow === $selectors.length\n        ? 'checked'\n        : 'indeterminate'\n\n      // reset props\n      $('#check-handle')\n        .prop('indeterminate', false)\n        .prop('checked', false)\n\n      if ($selectedRow) {\n        $('#check-handle').prop(prop, true)\n      }\n\n      // get info\n      self.getSelectedInfo()\n    })\n  },\n\n  handleClearSelected () {\n    const self = this\n    // clear selected rows\n    $('#myTable').on('page.dt', function () {\n      self.clearSelectedRows()\n    })\n    $('#clear-search').on('click', function () {\n      self.clearSelectedRows()\n    })\n  },\n\n  getSelectedInfo () {\n    const $selectedRow = $('input[name=\"selectedRow[]\"]:checked').length\n    const $info = $('.thead-btn')\n    const $badge = $('<span/>')\n      .addClass('selected-row-info text-muted pl-1')\n      .text(`${$selectedRow} selected`)\n    // remove existing info\n    $('.selected-row-info').remove()\n    // add current info\n    if ($selectedRow) {\n      $info.prepend($badge)\n    }\n  },\n\n  clearSelectedRows () {\n    $('#check-handle')\n      .prop('indeterminate', false)\n      .prop('checked', false)\n      .trigger('change')\n  }\n}\n\nadvanceDataTablesDemo.init()\n\n"]}